import React, {useState, useEffect} from 'react'

import { Text, View, TextInput, StyleSheet, TouchableOpacity } from 'react-native'

import {AsyncStorage} from '@react-native-community/async-storage'

const App = () => {

  const [info, setInfo] = useState('')
  const [text, setText] = useState('')

  
  async function saveValue () {
    try{
      if(info){
        await AsyncStorage.setItem('@key_default', info)
        .then(
          alert('Data saved!')
        )
      }
    }catch(e){
      alert('Please, fill the data!')
    }

  }

  async function getValue () {
    await AsyncStorage.getItem('@key_default').then(value => setText(value))
  }

  useEffect(() => {
    getValue()
  })

  return (
    <View style={styles.mainContainer}> 
    <Text>Using AsyncStorage</Text>
    <TextInput
    style={styles.textInput}
    placeholder = 'type here'
    value = {info}
    onChangeText={data => setInfo(data)}
    />
    <TouchableOpacity
    onPress={saveValue}
    style={styles.TouchableOpacity}
    >
      <Text>Save value</Text>
    </TouchableOpacity>
    <TouchableOpacity
    onPress={getValue}
    style={styles.TouchableOpacity}
    >
      <Text> Read value</Text>
    </TouchableOpacity>  
    <Text>Value read:{text}</Text>
  </View>
  )
}


export default App

const styles = StyleSheet.create({
  mainContainer: {
    flex: 1,
    padding: 20,
  },
  textInput: {
    marginTop: 10,
    borderWidth: 1,
    borderColor: '#fa19',
    fontSize: 15
  },
  TouchableOpacity: {
    width: '50%',
    marginTop: 10,
    borderWidth: 1,
    borderColor: '#fa19',
    padding: 10,
    alignSelf: 'center',
    alignItems: 'center'
  }
})